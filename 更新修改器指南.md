# 更新修改器数据指南

本指南将帮助您轻松更新网站上的修改器数据，**无需编写任何代码**！

## 为什么要使用JSON格式？

将Excel文件转换为JSON格式有以下好处：
- 网站加载速度更快（减少了Excel解析时间）
- 访问体验更流畅（特别是对于网络较慢的用户）
- 减少服务器资源消耗

## 更新步骤

### 步骤1: 编辑Excel文件

1. 打开 `data/修改器合集.xlsx` 文件
2. 添加、修改或删除游戏修改器信息
3. 保存文件（请确保使用相同的文件名和位置）

### 步骤2: 转换为JSON格式

**这是关键步骤！** 更新Excel文件后，您需要将其转换为JSON格式，以便网站能够快速加载。

我们提供了两种转换工具，您可以根据自己的系统环境选择使用：

### 方案一：Node.js版本（推荐）
1. 找到并双击 `convert.command` 文件
2. 等待转换完成（会显示进度信息）
3. 看到 "✅ 转换完成!" 的提示后，按任意键关闭窗口

### 方案二：Python版本（备用方案）
如果您的电脑上没有安装Node.js，请使用此方案：
1. 找到并双击运行 `convert_python.command` 文件
2. 程序会自动检查并安装必要的Python库
3. 等待转换完成（会显示进度信息）
4. 看到成功提示后，按任意键关闭窗口

## 转换工具工作原理

当您运行 `convert.command` 时，它会自动执行以下操作：
1. 检查是否安装了必要的软件（Node.js和xlsx库）
2. 如果没有安装，会自动尝试安装
3. 运行转换脚本，将Excel文件转换为JSON格式
4. 在 `data/backups` 文件夹中创建JSON文件的备份（以防万一）
5. **直接覆盖** `data/modifiers_data.json` 文件

**重要说明**：转换工具**不会创建新的JSON文件**，而是直接更新现有的`modifiers_data.json`文件，因此不会出现文件关联错误的问题。

## 网站如何使用这些数据

更新后的网站代码采用了智能加载机制：

1. **优先加载JSON文件**：网站会首先尝试加载 `data/modifiers_data.json` 文件，这个文件加载速度比Excel快3-5倍
2. **自动回退机制**：如果JSON文件加载失败或格式有问题，网站会自动回退到加载 `data/修改器合集.xlsx` 文件
3. **本地缓存优化**：成功加载数据后，网站会将数据缓存到本地存储中，提高后续访问速度

## 常见问题解答

### Q: 我需要学习编程才能更新数据吗？
**A: 不需要！** 您只需编辑Excel文件，然后双击运行转换工具即可。

### Q: 转换工具需要网络连接吗？
**A: 首次运行时需要**，以便下载必要的软件库。之后再次运行通常不需要网络连接。

### Q: 如果转换失败怎么办？
**A: 不用担心！** 网站会自动回退到加载原始的Excel文件，不会影响用户访问。您可以稍后再次尝试转换。

### Q: 转换后的文件会保存在哪里？
**A: 转换后的JSON文件** 会保存在 `data/modifiers_data.json`
**备份文件** 会保存在 `data/backups/` 文件夹中

## 注意事项
- 请确保Excel文件的格式保持不变，特别是表头行
- 如果您修改了Excel文件的结构，请先测试转换是否正常工作
- 建议定期备份您的Excel文件，以防数据丢失

如果您在使用过程中遇到任何问题，请联系技术支持。